<!doctype html>
<html lang="en-US">
<head>

	<meta charset="utf-8">

	<title>Prueba</title>

    
   <! //funcion para conectar con firebase>
    <script src="https://www.gstatic.com/firebasejs/5.0.4/firebase.js"></script>
   
    <script>
      // Aqui se inicializa firebase
      var config = {
        apiKey: "AIzaSyAJKAc_-VwG7Lt_LeSjbNnr8LEzms1WJxk",
        authDomain: "btq-ahm-gran-hotel.firebaseapp.com",
        databaseURL: "https://btq-ahm-gran-hotel.firebaseio.com",
        projectId: "btq-ahm-gran-hotel",
        storageBucket: "btq-ahm-gran-hotel.appspot.com",
        messagingSenderId: "241886061865"
      };
      firebase.initializeApp(config);
    </script>

    <script>
      //Aqui termina la conexcion a firebase



    //Funcion para mantener la sesion iniciada cuando se cierra la pestaña o navegador

    firebase.auth().onAuthStateChanged(function(user) {
    if (user) {
      // Usuario con sesion iniciada
  
      document.getElementById("user_div").style.display = "block";
      document.getElementById("login_div").style.display = "none";
  
      var user = firebase.auth().currentUser;
  
      if(user != null){
  
        var email_id = user.email;
        document.getElementById("user_para").innerHTML = "Welcome User : " + email_id;
  
      }
  
    } else {
      // Si el usuario no tiene la sesion iniciada
  
      document.getElementById("user_div").style.display = "none";
      document.getElementById("login_div").style.display = "block";
  
    }
  });

  //Aqui termina la funcion para mantener la sesion iniciada cuando se cierra la pestaña o navegador

   



  //Aqui inicia la funcion de registrar un nuevo usuario con email y pass
    function nuevo_usuario(){

    document.getElementById("user_div").style.display = "none";
    document.getElementById("login_div").style.display = "block";
    document.getElementById("registro").style.display = "none";  

    var newuserEmail = document.getElementById("new_email_field").value;
    var newuserPass = document.getElementById("new_password_field").value;

    firebase.auth().createUserWithEmailAndPassword(newuserEmail, newuserPass).catch(function(error) {
    // Errores en caso de que no se pueda registrar
    var errorCode = error.code;
    var errorMessage = error.message; 
    window.alert("Error : " + errorMessage);
    });
    }
  //Aqui termina la funcion de registrar un nuevo usuario con email y pass




     //login con correo y contraseña
  function login(){
  
    var userEmail = document.getElementById("email_field").value;
    var userPass = document.getElementById("password_field").value;
  
    firebase.auth().signInWithEmailAndPassword(userEmail, userPass).catch(function(error) {
      // Errores en caso de que no pueda iniciar sesion
      var errorCode = error.code;
      var errorMessage = error.message;
      window.alert("Error : " + errorMessage);
    });
  
  }
      //aqui termina login con correo y contraseña




    //Aqui inicia el cierre de sesion del usuario de los 3 metodos
  function logout(){
    firebase.auth().signOut();
    firebase.auth().signOut().then(function() {
      //Si cierra sesion correctamente
    }).catch(function(error) {
      //Si sucede algun error
    });
  }
    //Aqui termina el cierre de sesion del usuario de los 3 metodos




    //Aqui inicia funcion para iniciar sesion con google
  function google_login(){
    
    var provider = new firebase.auth.GoogleAuthProvider();
	  firebase.auth().signInWithPopup(provider).then(function(result) {
        // Te da el token de google. Se usa para iniciar en la api
        var token = result.credential.accessToken;
        // Te da la informacion del usuario
        var user = result.user;
        // Si no se obtiene el token correctamente se ejecuta la siguiente funcion
        }).catch(function(error) {
        // Errores en caso de no recibir el token correctamente
        var errorCode = error.code;
        var errorMessage = error.message;
        // El correo ya esta registrado en la base de datos
        var email = error.email;
        // Si la credencial de auth ya esta usada.
        var credential = error.credential;
        // ...
        window.alert("Error : " + errorMessage);
    });
  }
    //Aqui termina funcion para iniciar sesion con google





    //Aqui inicia funcion para iniciar sesion con facebook

  function facebook_login(){

      var provider = new firebase.auth.FacebookAuthProvider();
      
        firebase.auth().signInWithPopup(provider).then(function(result) {
        // Te da el token de inicio de sesion de facebook
        var token = result.credential.accessToken;
        // Obtiene la informacion del usuario
        var user = result.user;
        // En caso de no iniciar sesion correctamente se ejecuta la siguiente funcion
      }).catch(function(error) {
        // Errores en caso de no iniciar sesion
        var errorCode = error.code;
        var errorMessage = error.message;
        // El correo ya esta registrado en la base de datos
        var email = error.email;
        // La credencial Auth ya esta usada
        var credential = error.credential;
        // ...
      });
    }
    //Aqui termina funcion para iniciar sesion con facebook




      //Aqui inicia la funcion para ocultar la pestaña de inicio y mostrar la de registro
  function pestaña_registro(){
      document.getElementById("registro").style.display = "block";
      document.getElementById("login_div").style.display = "none";
  }
      //Aqui termina la funcion para ocultar la pestaña de inicio y mostrar la de registro





      //Aqui inicia la funcion para ocultar cualquier pestaña y mostrar la de inicio
  function pestaña_inicio(){
    document.getElementById("login_div").style.display = "block";
    document.getElementById("user_div").style.display = "none";
    document.getElementById("registro").style.display = "none";  
  }
        //Aqui termina la funcion para ocultar cualquier pestaña y mostrar la de inicio


  
  </script>
</head>




<body> 
  <! Aqui inicia la pestaña de inicio >

    <div id="login_div" class="main-div">     
        <h3>Login</h3>        
        <button onclick="facebook_login()"><img href="facebook_icon.png"/> Continuar con Facebook </button>
        <br>
        <button onclick="google_login()"><i></i> Continuar con Google </button>
        <br>
        <input type="email" placeholder="Email..." id="email_field" />
        <input type="password" placeholder="Password..." id="password_field" />
        <button onclick="login()">Ingresa a tu cuenta </button>
        <br>
        <button onclick="pestaña_registro()"> Registrate </button>
     </div>
    <! Aqui termina la pestaña de inicio >
      


      <! Aqui inicia html para registro de usuario por correo > 
       <div id="registro" class="loggedin-div">
        <h3>Registrate con tu correo: </h3>
        <input type="email" placeholder="Correo" id="new_email_field" required/>
        <input type="password" placeholder="Contraseña" id="new_password_field" required/>
        <button onclick="nuevo_usuario()">Registrate </button>
        <br>
        <button onclick="pestaña_inicio()">Atras <-</button>
      </div>
      <! Aqui termina html para registro de usuario por correo >     




      <! Aqui inicia html en caso de iniciar sesion con cualquier metodo, muestra esta pestaña >
      <div id="user_div" class="loggedin-div">
        <h3>Bienvenido Usario: </h3>
        <p id="user_para">Estas actualmente conectado.</p>
        <button onclick="logout()">Cerrar Sesion</button>
      </div>
      <! Aqui termina html en caso de iniciar sesion con cualquier metodo, muestra esta pestaña >






      <style>
      
      body {
    background: #fff;
    padding: 0px;
    margin: 0px;
    font-family: 'Nunito', sans-serif;
    font-size: 16px;
  }
  
  input, button {
    font-family: 'Nunito', sans-serif;
    font-weight: 700;
  }
  
  .main-div, .loggedin-div {
    width: 20%;
    margin: 0px auto;
    margin-top: 150px;
    padding: 20px;
    display: none;
  }
  
  .main-div input {
    display: block;
    border: 1px solid #ccc;
    border-radius: 5px;
    background: #fff;
    padding: 15px;
    outline: none;
    width: 100%;
    margin-bottom: 20px;
    transition: 0.3s;
    -webkit-transition: 0.3s;
    -moz-transition: 0.3s;
  }
  
  .main-div input:focus {
    border: 1px solid #777;
  }
  
 .loggedin-div input {
    display: block;
    border: 1px solid #ccc;
    border-radius: 5px;
    background: #fff;
    padding: 15px;
    outline: none;
    width: 100%;
    margin-bottom: 20px;
    transition: 0.3s;
    -webkit-transition: 0.3s;
    -moz-transition: 0.3s;
  }
  
  .loggedin-div input:focus {
    border: 1px solid #777;
  }


  .main-div button, .loggedin-div button {
    background: #5d8ffc;
    color: #fff;
    border: 1px solid #5d8ffc;
    border-radius: 5px;
    padding: 15px;
    display: block;
    width: 100%;
    transition: 0.3s;
    -webkit-transition: 0.3s;
    -moz-transition: 0.3s;
  }
  
  .main-div button:hover, .loggedin-div button:hover {
    background: #fff;
    color: #5d8ffc;
    border: 1px solid #5d8ffc;
    cursor: pointer;
  }
  

      </style>

</body>
</html>